# 1장 나에게 도메인 주도 설계는

- [DDD가 우리에게 상처를 줄까?](#DDD가-우리에게-상처를-줄까?)
- [좋은, 나쁜 그리고 효과적인 설계](#좋은,-나쁜-그리고-효과적인-설계)
- [전략적 설계](#전략적-설계)
- [전술적 설계](#전술적-설계)
- [학습 과정과 지식의 정제](#학습-과정과-지식의-정제)
- [이제 시작해보자!](#이제-시작해보자!)

DDD는 높은 가치를 제공하는 소프트웨어를 설계하고 구현하는 데 있어 전략적, 전술적으로 도움을 주는 도구들의 모음이다.

조직은 모든 면에서 최고일 수는 없기 때문에 집중해야 하는 것을 신중하게 선택해야 한다.

DDD는 최고의 소프트웨어 설계 결정들과 비즈니스를 위한 통합적인 판단을 할 수 있게 도와준다.

## DDD가 우리에게 상처를 줄까?

- DDD는 소프트웨어 개발에 대한 복잡한 접근법이 아니다.
- 접근 자체가 복잡한 것은 아니다. 정확하게는 DDD는 복잡한 소프트웨어 프로젝트에 사용할 수 있는 수준 높은 기술들의 집약체이다.
- DDD는 소프트웨어의 복잡성을 해결하는 데 사용한다.
- 이 책은 DDD의 가장 중요한 부분만 요약했다. 참고서라 생각하자.

## 좋은, 나쁜 그리고 효과적인 설계

좋은 설계와 나쁜 설계는 어떤걸까?

```text
설계가 필수적인 것인지, 안 해도 괜찮은지에 대한 질문은
요점에서 많이 벗어나 있다.

설계는 필연적이다.
좋은 설계의 대안은 나쁜 설계다. 절대 설계하지 않는 것이 아니다.
- Book Design: A Practical Introduction by 더글라스 마틴
```

- 설계는 의도가 잘 들어나도록 해야한다.
  - 단순히 `작업 보드 셔플` 개념이 아니다.
- **지식획득**을 감안해야 한다.
- 비즈니스 관계자 및 프로젝트에 참여하는 모든 사람들의 의사를 반영해야 한다.
- 구현 과정에서 도메인 전문가의 도메인 지식을 투영할 수 있도록 해야 한다.
- 좋은 설계는 효과적인 설계다.
  - `좋은 것`과 `효과적인 것`은 밀접한 관련이 있다.
  - 소프트웨어 설계에 좀 더 노력해야 한다는 것을 명확하게 말해준다.
  - 효과적인 설계는 조직의 강점을 활용하고, 정확한 소프트웨어 모델을 생성하도록 가이드할 때 사용한다.
- 스크럼을 통한 지식 획득은 실험과 협업 학습을 통해 이뤄지며, 이를 `정보 구입(Essential Scrum)`이라고도 한다.
- 소프트웨어에서 효과적인 설계는 매우 중요하다.
  - 단 한 가지 방안만을 추천하라면, 효과적인 설계를 추천하겠다.

```text
대부분의 사람들은 '설계를 고민한다는 것'이 
'어떻게 생긴 것인지 고민하는 것'으로 착각한다.

설계자에게 어떤 박스를 건네주고 "좋아 보이게 만들어!"라는 이야기 정도로 생각한다.

이건 우리가 생각하는 설계가 아니다. 
설계는 단지 어떻게 생겼는지, 어떤 느낌인지가 아니라. 
그게 어떻게 동작하는지에 대한 것이다.
- 스티브 잡스
```

나쁜 설계는 "설계하지 않는 것이 낮은 비용의 소프트웨어로 이어진다"라는 사상에서 기안된다.

- 소프트웨어 개발을 이익 중심이 아닌 원가 중심으로 생각한다.
  - 소프트웨어의 전략적 이점보다, 비즈니스를 해결하기 위한 골칫거리 정도로 바라보기 때문이다.
- 해결해야할 문제를 연구하고 설계하지 않는다.
  - 개발자가 기술에만 몰두한 나머지 최신 기술 트렌드만 쫒는 경향이 있다.
- 데이터베이스의 데이터에 너무 몰두한다.
  - 모델을 단순한 데이터의 집합이라 생각하는 경향이 있다.
- 개발자가 비즈니스 목적에 따라 클래스와 오퍼레이션 이름을 짓는 것에 크게 관심이 없다.
  - 비즈니스가 담고 있는 멘탈 모델과 개발자가 만들어낼 소프트웨어 사이에 큰 차이를 야기한다.
- 위 문제들은 일반적으로 비즈니스와의 협업이 빈약하기 때문에 발생하는 결과다.
  - 비즈니스 이해관계자가 아무도 사용하지 않고 개발자들이 고작 일부분만 읽어보는 명세서를 작성하느라 홀로 너무 많은 시간을 보낸다.
- 프로젝트에 대한 예측을 매우 강하게 요구한다.
  - 너무 자주 예측치를 추정하는 것은 많은 시간을 할애 하도록 만든다.
  - 소프트웨어가 지연되는 결과로 이어질 수도 있다.
  - 개발자들은 심사숙고한 설계보다 `작업 보드 셔플`을 사용한다.
  - `적절하게 분리된 모델`이 아닌 큰 `진흙 덩어리`를 만들어 낸다.
- 해결해야 할 비즈니스 로직을 애플리케이션 계층에 추가 한다.
  - 인터페이스 컴포넌트와 영속성 컴포넌트 안에 추가한다. 
  - 또한 종종 영속성 오퍼레이션을 비즈니스 로직 중간에 수행하기도 한다.
- 문법에 어긋나고 느리거나 권한이 없어 차단되는 데이터베이스 쿼리들이 사용자가 긴급하게 처리해야 하는 비즈니스 업무를 수행하지 못하도록 방해한다.
- 완벽한 설계는 없다.
  - 개발자가 실제 구체적인 비즈니스 요구 대신, 현재와 상상 속 미래의 요구를 모두 고려해서 과도하게 일반화시킨 해결 방안을 선택한 탓에 잘못된 추상화가 존재한다.
- 서비스간 강결합이 존재한다.
  - 오퍼레이션을 수행하는 서비스가 또 다른 서비스를 직접 호출하는 강하게 결합된 서비스가 존재한다.
  - 이 결합은 시스템 유지보수가 어려워질 뿐만 아니라 종종 비즈니스 프로세스에 문제를 일으키고 데이터가 불일치가 되는 결과로 이어진다.

## 전략적 설계

- 전략적 설계부터 시작하지 않으면 절대 효과적인 방법으로 전술적인 설계를 적용할 수 없다.
- 전략적 설계는 비즈니스상 전략적으로 중요한 것을 다뤄야 한다.
- 전략적 설계는 중요도에 따라 일을 나누는 방법 그리고 필요에 따라 통합하는 최적의 방법을 강조한다.

전략적 설계의 중요한 키워드는 다음과 같다.

- 바운디드 컨텍스트(Bounded Context)
  - 전략적 설계 패턴으로 도메인 모델을 분리하는 방법
  - 물리적인 시스템
- 보편 언어(Ubiquitous Language)
  - 의사소통과 소프트웨어 모델 곳곳에 보편적이고, 널리 퍼져 있다.
- 서브 도메인(Sub domain)
  - 기존 시스템을 제한하고 복잡성을 어떻게 다룰 수 있는지
- 컨텍스트 매핑(Context Mapping)
  - 바운디드 컨텍스트를 통합하는 방법
  - 통합하는 과정에서 그 사이에 존재하는 팀의 관계, 기술적 매커니즘을 정의한다.

## 전술적 설계

전술적 설계 단계는 도메인 모델의 세부사항을 구현하는 도구라 생각하면 된다.

- 엔티티(Entity)
  - 식별자와 상태를 가진다.
- 밸류(Value Object)
  - 값 그 자체
- 애그리커트(Aggregate)
  - 엔티티와 밸류의 묶음
- 도메인 이벤트(Domain Event)
  - 도메인에서 과거에 발생한 일을 시스템과 공유하는 것을 돕는다.
  - 공유할 대상이 로컬의 바운디드 컨텍스트일 수도, 다른 원격의 바운디드 컨텍스트일 수도 있다.

## 학습 과정과 지식의 정제

팀이 비즈니스의 핵심 역량에 대해 배워갈 때, DDD는 지식을 더욱 발전시킬 수 있도록 생각하는 법을 알려준다.

현 상황에 대해 질문을 던지고, 소프트웨어 모델의 가정에 이의를 제기함으로써 더 많이 배우고, 중요한 지식 획득은 팀 전체로 확산된다.

이것은 비즈니스와 팀을 위한 상당히 중요한 투자다. 배우고 정제하는 것뿐만 아니라 그것을 빨리 해내는 것을 목표로 삼아야 한다.

## 이제 시작해보자!

2장 바운디드 컨텍스트 및 보편언어와 전략적 설계 부터 시작해보자.
